# TCP

## 特性
- 面向连接、可靠的字节流服务
- 两端通信
- 校验和保证数据准确性
- 序号确认保证消息时序
- 滑动窗口控制流量

## 握手挥手

### 握手

1. 客户端发送包（SYN=1,seq=x），携带初始序号seq
2. 服务端返回（SYN=1，ACK=1，seq=y，ACKnum=x+1）
3. 客户端回复（ACK=1，ACKnum=y+1）

## KeepAlive


## 粘包、拆包

- 现象：接收端收到的同一个数据包包含发送端发送的两个数据包的数据
- 原因：
  - 发送的数据长度大于TCP发送缓冲区剩余大小，会拆包
  - 待发送数据大于 MSS（最大报文长度）
  - 待发数据太小，TCP合并多个小数据一起发送
- 解决：
  - 消息定长
  - 设置消息边界
  - 区分消息头和消息体，消息头携带消息长度
  - 应用层协议解决
- TCP面向连接，基于字节流，才会出现该现象，UDP基于报文，首部又一个16bit的字段标示报文长度，故不会



