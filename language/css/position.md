# 定位

一旦生成了盒子以后，CSS引擎就需要定位它们以完成布局。下面是定位盒子时所使用的规则：

- 普通流：按照次序依次定位每个盒子
- 浮动：将盒子从普通流中单独拎出来，将其放到外层盒子的某一边
- 绝对定位：按照绝对位置来定位盒子，其位置根据盒子的包含元素所建立的绝对坐标系来计算，因此绝对定位元素有可能会覆盖其他元素

## 常规流

当CSS的 position 属性为 static 或 relative，并且 float 为 none 时，其布局方式为普通流。

常规流汇总的盒属于一个格式化上下文，可能是块或者行内格式化上下文。块级盒参与块格式化上下文。行内级盒参与行内格式化上下文。

### 块格式化上下文

浮动，绝对定位的元素，非块盒的块容器（例如inline-blocks，table-cells和table-captions），以及’overflow’不为’visible’的块盒（当该值已被传播到视口时除外（except when that value has been propagated to the viewport））会为其内容建立新的块格式化上下文。

- 上下文中盒在垂直方向一个接一个地放置。
- 同一个上下文中的相邻块级盒之间的垂直外边距会合并

### 行内格式化上下文

- 在行内格式化上下文中，盒是从包含块的顶部开始一个挨一个水平放置的。
- 盒可能会以不同的方式垂直对齐：以它们的底部或者顶部对齐，或者以它们里面的文本的基线对齐。包含来自同一行的盒的矩形区域叫做行框
- 行框的宽度由包含块和浮动情况决定，行框的高度由行高的计算小节给出的规则决定
- 同一行内格式化上下文的行框一般宽度相当，但如果某一行有浮动元素，挤压了行框的宽度，可能就会出现宽度不同的情况
- 当行内盒超出行框宽度时，它会被分成几个盒，并且这些盒会跨多行框分布，若一个行内块无法分割，则从行框溢出

### 相对定位

偏移某个盒不会影响其他盒的定位。这表明相对定位可能会导致盒重叠。然而，如果相对定位导致具有'overflow:auto'或'overflow:scroll'的盒溢出了的话，UA必须让用户能够访问这部分内容（在其偏移位置），此时，滚动条的创建可能会影响布局

## 浮动

在浮动定位中，浮动盒子会浮动到当前行的开始或尾部位置。这会导致普通流中的**文本及其他内容**会“流”到浮动盒子的边缘处，除非元素通过 clear 清除了前面的浮动。

## 绝对定位

在绝对定位中，盒子会完全从当前流中移除，并且不会再与其有任何联系（译注：此处仅指定位和位置计算，而绝对定位的元素在文档树中仍然与其他元素有父子或兄弟等关系），其位置会使用 top、bottom、left 和 right 相对其包含块进行计算。

