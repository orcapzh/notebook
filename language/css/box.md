# 盒子模型

文档进行布局时，渲染引擎根据CSS基础盒模型（CSS basic box model）进行。分为块级盒和内联盒。

盒子包含内容、内边距、边框、外边距。

## 块级盒与行内盒

- 当元素的 display 为 block、list-item 或 table 时，该元素将成为块级元素。
- 如果一个元素的 display 属性为 inline、inline-block 或 inline-table，则称该元素为行内级元素。

- 块盒子总是不与前一个块级元素同行
- 块级盒宽度自动撑满父容器
- 块级盒高度自适应内容
- 行内盒子不影响垂直高度，垂直方向margin无效，且垂直方向padding不会影响周围盒子的布局
- 行内盒子宽度自适应内容

一个块级盒子可能也是一个块容器盒子。块容器盒子（block container box）要么只包含其它块级盒子，要么只包含行内盒子并同时创建一个行内格式化上下文（inline formatting context）。

换句话说：如果**块容器盒里面有一个块级盒**，那么我们强制让它里面**只含有块级盒**

当**行内盒**包含流内**块级盒**时，该行内盒（及与它处于同一行框里的行内祖先）会打破周围的块级盒（以及任何连续的或只被可合并的空白符和/或流外元素隔开的块级兄弟），把行内盒分成两个盒（即使有一边是空的），分别位于块级盒的两边。拆分前的行框与拆分后的行框都被包进匿名块盒，并且该块级盒作为这些匿名盒的兄弟。当这样一个行内盒受到相对定位的影响时，任何由此产生的位移也会影响行内盒里面的块级盒


## 改变盒子的行为

我们可以通过`display`改变盒子的行为。
盒子的大小与盒子类型有关，分为`content-box`和`border-box`。

- content-box：`width`属性只指定盒子中内容的宽度
- border-box：`width`属性指定的宽度包含内边距和边框的宽度

## 相关概念

**块级盒子**描述了元素与其父元素和兄弟元素之间的行为。**块容器盒子**描述元素跟其后代之间的行为。

- 块：block，一个抽象的概念，一个块在文档流上占据一个独立的区域，块与块之间在垂直方向上按照顺序依次堆叠。
- 包含块：containing block，包含其他盒子的块称为包含块。
- 盒子：box，一个抽象的概念，由CSS引擎根据文档中的内容所创建，主要用于文档元素的定位、布局和格式化等用途。盒子与元素并不是一一对应的，有时多个元素会合并生成一个盒子，有时一个元素会生成多个盒子（如匿名盒子）。
- 块级元素：block-level element，元素的 display 为 block、list-item、table 时，该元素将成为块级元素。元素是否是块级元素仅是元素本身的属性，并不直接用于格式化上下文的创建或布局。
- 块级盒子：block-level box，由块级元素生成。一个块级元素至少会生成一个块级盒子，但也有可能生成多个（例如列表项元素）。
- 块盒子：block box，如果一个块级盒子同时也是一个块容器盒子（见下），则称其为块盒子。除具名块盒子之外，还有一类块盒子是匿名的，称为匿名块盒子（Anonymous block box），匿名盒子无法被CSS选择符选中。
- 块容器盒子：block container box或block containing box，块容器盒子侧重于当前盒子作为“容器”的这一角色，它不参与当前块的布局和定位，它所描述的仅仅是当前盒子与其后代之间的关系。换句话说，块容器盒子主要用于确定其子元素的定位、布局等。

**注意：盒子分为“块盒子”和“块级盒子”两种，但元素只有“块级元素”，而没有“块元素”。下面的“行内级元素”也是一样。**

- 行内级元素：inline-level element，display 为 inline、inline-block、inline-table 的元素称为行内级元素。与块级元素一样，元素是否是行内级元素仅是元素本身的属性，并不直接用于格式化上下文的创建或布局。
- 行内级盒子：inline-level box，由行内级元素生成。行内级盒子包括行内盒子和原子行内级盒子两种，区别在于该盒子是否参与行内格式化上下文的创建。
- 行内盒子：inline box，参与行内格式化上下文创建的行内级盒子称为行内盒子。与块盒子类似，行内盒子也分为具名行内盒子和匿名行内盒子（anonymous inline box）两种。
- 原子行内级盒子：atomic inline-level box，不参与行内格式化上下文创建的行内级盒子。原子行内级盒子一开始叫做原子行内盒子（atomic inline box），后被修正。原子行内级盒子的内容不会拆分成多行显示。

## 边距合并

CSS中，相邻的多个盒子的外边距会被合并。

相邻垂直方向外边距合并，除了以下情况：
- 根元素margin不合并
-