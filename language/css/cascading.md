# 层叠

通过样式表，按照一定顺序进行相互覆盖，得到最终的样式。

## 样式表来源

- 编写者
- 用户
- 用户代理

默认情况下权重：

编写者 > 用户表 > 用户代理

!important规则权重：

用户表 > 编写者 > 用户代理

## 层叠顺序

1. 匹配 媒体查询 类型
2. 根据来源于重要性（important）优先级
   1. 用户代理声明
   2. 用户常规声明
   3. 编写者常规声明
   4. 编写者重要声明
   5. 用户重要声明
3. 相同来源、重要性的规则通过选择器的**特殊性**进行排序 （伪元素和伪类分别算常规元素和类）
4. 按照指定顺序，同等权重、来源和特殊性的，后指定的生效。
5. 引入样式表（import）中的声明被认为在样式表自身的所有声明之前

## 选择器特殊性

计算规则：

- 如果声明来自一个'style'属性而不是一条选择器样式规则，算1，否则就是0 (= a)（HTMl中，一个元素的"style"属性值是样式表规则，这些属性没有选择器，所以a=1，b=0，c=0，d=0）
- 计算选择器中ID属性的数量 (= b)
- 计算选择器中其它属性和伪类的数量 (= c)
- 计算选择器中元素名和伪元素的数量 (= d)

```css
 *             {}  /* a=0 b=0 c=0 d=0 -> specificity = 0,0,0,0 */
 li            {}  /* a=0 b=0 c=0 d=1 -> specificity = 0,0,0,1 */
 li:first-line {}  /* a=0 b=0 c=0 d=2 -> specificity = 0,0,0,2 */
 ul li         {}  /* a=0 b=0 c=0 d=2 -> specificity = 0,0,0,2 */
 ul ol+li      {}  /* a=0 b=0 c=0 d=3 -> specificity = 0,0,0,3 */
 h1 + *[rel=up]{}  /* a=0 b=0 c=1 d=1 -> specificity = 0,0,1,1 */
 ul ol li.red  {}  /* a=0 b=0 c=1 d=3 -> specificity = 0,0,1,3 */
 li.red.level  {}  /* a=0 b=0 c=2 d=1 -> specificity = 0,0,2,1 */
 #x34y         {}  /* a=0 b=1 c=0 d=0 -> specificity = 0,1,0,0 */
 style=""          /* a=1 b=0 c=0 d=0 -> specificity = 1,0,0,0 */
```

## 非CSS表现型提示的样式优先级


